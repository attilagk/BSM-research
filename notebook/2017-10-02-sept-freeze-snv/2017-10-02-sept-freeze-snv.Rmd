---
layout: default
title: SNVs from Sept 2017 Data Freeze
tags: [ mutect2 ]
featimg: "lod-zoom-1.png"
---

The BSM Consortium decided on a data freeze due on Sept 1 2017.  Data from the Chess lab was analyzed by Alon Galor from the Park lab.  Four VCF files were generated by Alon, one using GATK Mutect2.  This file is further analyzed here with respect to the probabilistic LOD score associated to each variant candidate.

## Preparation

Split the single `INFO` column into multiple columns and write into a `.csv` file

```{r eval=TRUE, engine='bash'}
indir="$HOME/projects/bsm/results/common-experiment/snv/2017-08-29-alon-galor/"
invcf="${indir}/5154_fibroblast-5154_NeuN_positive-Fibro_Common_7-Fibro_Common_7-768-13812.vcf"
outfile="$HOME/projects/bsm/results/2017-10-02-sept-freeze-snv/alon-mutect.csv"
sed -n '/^#CHROM/,$ p' $invcf | sed -n '2,$ p' | tr '\t;=' ',' > $outfile
```

```{r echo=FALSE, warning=FALSE}
library(lme4)
library(lattice)
#library(latticeExtra)
opts_chunk$set(dpi = 144)
opts_chunk$set(out.width = "700px")
opts_chunk$set(dev = c("png", "pdf"))
lattice.options(default.args = list(as.table = TRUE))
lattice.options(default.theme = "standard.theme")
```

Read the `.csv` file and extract the NLOD and TLOD values, producing a "long" data frame for convenient plotting with the `lattice` package.  NLOD and TLOD are log odds scores providing evidence for somatic mosaicism either for the normal (NLOD) or tumor (TLOD) tissue.  In this case fibroblasts are taken normal and NeuN+ nuclei as tumor tissue.

```{r}
f <- "~/projects/bsm/results/2017-10-02-sept-freeze-snv/alon-mutect.csv"
vcf <- read.csv(f, header = FALSE)
l <- list(
          nlod = subset(vcf, vcf$V16 == "NLOD", select = c(16:17)),
          tlod = subset(vcf, vcf$V18 == "TLOD", select = c(18:19)))
names(l$nlod) <- c("type", "LOD")
names(l$tlod) <- c("type", "LOD")
df <- rbind(l$nlod, l$tlod)
levels(df$type) <- c("fibroblast", "RPA", "NeuN+")
```

## Distribution of LOD scores

The figures below show the distribution of the NLOD and TLOD score providing evidence for somatic mosaicism in fibroblasts or NeuN+ nuclei.  The TLOD distribution is wider and shifted to the right relative to the NLOD distribution suggesting that mosaicism is more common in NeuN+ cells than in fibroblasts.

```{r lod}
histogram(~ LOD | type, data = df, type = "count")
```

Zooming in on the few most highly scoring candidate variants doesn't reveal a clearly bimodal distribution that could be interpreted as well-separated sets false and true positives.

```{r lod-zoom}
histogram(~ LOD | type, data = df, type = "count", ylim = c(0, 50))
```

```{r lod-zoom-density}
densityplot(~ LOD | type, data = df, ylim = c(-1e-4, 5e-3), plot.points = "rug")
```
