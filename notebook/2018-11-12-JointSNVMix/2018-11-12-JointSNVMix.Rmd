---
layout: default
title: JointSNVMix2
tags: [ JointSNVMix2 ]
#featimg: "all-1.png"
---

Testing JointSNVMix and inspecting its output.

The `bash` code below shows how the `jsm.tsv` files have been generated.  See details in each `runme` file.

```{r engine="bash", eval=FALSE}
# run JointSNVMix2 
cd $HOME/projects/bsm/results/2018-11-12-JointSNVMix
for wd in chr22 1Mb 10Mb 100Mb; do
    $wd/runme & # asynchronous evaluation (each process runs on thread)
done
# ...wait for all processes to complete...
# downsample rows (genome positions): keep every 1000th
$HOME/projects/bsm/notebook/2018-11-12-JointSNVMix/sample-every chr22/jsm.tsv 1000
```

```{r engine="bash", eval=TRUE}
# run JointSNVMix2 
cd $HOME/projects/bsm/results/2018-11-12-JointSNVMix
head -n2 chr22/jsm.tsv.every-1000
```


```{r echo=FALSE, warning=FALSE, message=FALSE}
library(lattice)
library(latticeExtra)
opts_chunk$set(dpi = 144)
opts_chunk$set(out.width = "600px")
opts_chunk$set(dev = c("png", "pdf"))
lattice.options(default.args = list(as.table = TRUE))
lattice.options(default.theme = "standard.theme")
```

```{r}
tsv <- "~/projects/bsm/results/2018-11-12-JointSNVMix/chr22/jsm.tsv.every-1000"
records <- read.delim(tsv)
# aggregate probabilities
# across genotypes for the case/tumor sample
records$p_AA_XX <- with(records, p_AA_AA + p_AA_AB + p_AA_BB)
records$p_AB_XX <- with(records, p_AB_AA + p_AB_AB + p_AB_BB)
records$p_BB_XX <- with(records, p_BB_AA + p_BB_AB + p_BB_BB)
# across genotypes for the control/normal sample
records$p_XX_AA <- with(records, p_AA_AA + p_AB_AA + p_BB_AA)
records$p_XX_AB <- with(records, p_AA_AB + p_AB_AB + p_BB_AB)
records$p_XX_BB <- with(records, p_AA_BB + p_AB_BB + p_BB_BB)
records.l <-
    reshape(records, varying = v <- grep("p_", names(records), value = TRUE),
            v.names = "p", timevar = "GT", times = sub("p_", "", v), direction = "long")
```

```{r controlGT}
histogram(~ p_AA_XX + p_AB_XX + p_BB_XX, data = records, layout = c(3, 1), main = "Control sample genotype", xlab = "posterior probability")
```

```{r caseGT}
histogram(~ p_XX_AA + p_XX_AB + p_XX_BB, data = records, layout = c(3, 1), main = "Case sample genotype", xlab = "posterior probability")
```
